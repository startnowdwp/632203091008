<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <style>
        /* 复用选项卡样式 */
        .tab { overflow: hidden; border: 1px solid #ccc; background: #f1f1f1 }
        .tab button { 
            padding: 14px 16px; 
            font-size: 17px;
            position: relative;
            transition: all 0.3s ease;
            margin-right: 5px;
        }
        .tab button:not(:last-child):after {
            content: "→";
            position: absolute;
            right: -10px;
            top: 50%;
            transform: translateY(-50%);
            color: #2c3e50;
            font-weight: bold;
        }
        .tab button.active {
            background-color: #2c3e50;
            color: white;
            font-weight: bold;
        }
        .tab button:hover {
            background-color: #ddd;
        }
        .tabcontent { display: none; padding: 20px }
        table { width: 100%; border-collapse: collapse }
        th, td { border: 1px solid #ddd; padding: 12px }
        th { background-color: #2c3e50; color: white }
        .scroll-table { overflow-x: auto }
        .formula { background: #f8f9fa; padding: 15px; margin: 15px 0 }
    </style>
</head>
<body>
    <div class="tab">
        <button class="tablinks" onclick="openTab(event, 'Data')">① 数据整理</button>
        <button class="tablinks" onclick="openTab(event, 'Weight')">② 熵权法赋权</button>
        <button class="tablinks" onclick="openTab(event, 'RSR')">③ RSR分布</button>
        <button class="tablinks" onclick="openTab(event, 'Regression')">④ 回归分档</button>
        <button class="tablinks" onclick="openTab(event, 'Map')">⑤ 地图可视化</button>
    </div>

    <!-- 数据整理 -->
    <div id="Data" class="tabcontent">
        <h3>POI分类标准</h3>
        <p>采用秩和比综合评价法（RSR）对304公交线路各站点进行多维度评估。数据源涵盖平峰与高峰时段的上下车客流、轨道接驳属性、公交线路覆盖数量，以及站点300米半径范围内的住宅、商业、文化三类POI数量，POI分类关键词根据下表规定。</p>
        <table>
            <tr><th>POI类型</th><th>包含关键词</th></tr>
            <tr><td>商业</td><td>购物, 超市, 便利店, 商铺, 美食, 餐厅, 中餐厅, 小吃快餐店 酒店, 快捷酒店, 公司, 维修点, 宠物服务, 丽人, 美发, 生活服务家居建材, 公司企业, 家居, 维修</td></tr>
            <tr><td>住宅</td><td>住宅区, 房地产, 住宅, 小区, 内部楼栋, 住宅楼</td></tr>
            <tr><td>文化</td><td>教育培训, 培训机构, 公园, 旅游景点, 文化, 游戏场所, 公检法机构, 政府机构, 学校, 景点, 文化馆, 体育</td></tr>
        </table>

        <h3>数据说明</h3>
        <p>平峰站点上下车客流采用了4.11调查数据中的上行客流量数据；高峰站点上下车客流采用3.31调查数据中的下行客流量数据，因其调查时段处于17：40-18：40，更符合晚高峰时段的定义；是否为轨道接驳站点指标是一个二元分类数据，数据来源：https://www.cqgj.net/index/index/；覆盖公交线路数量是指在该站点设置停靠的线路数量总和，数据来源：https://chongqing.8684.cn/x_adde86f7。</p>
        <div class="scroll-table">
            <table style="min-width: 1200px">
                <tr><th>站点名称</th><th>平峰客流</th><th>高峰客流</th><th>轨道接驳</th><th>公交线路数</th><th>住宅POI</th><th>商业POI</th><th>文化POI</th></tr>
                <tr><td>南坪（东路）</td><td>22</td><td>9</td><td>1</td><td>27</td><td>31</td><td>594</td><td>29</td></tr>
                <tr><td>万寿站</td><td>30</td><td>0</td><td>1</td><td>12</td><td>63</td><td>701</td><td>33</td></tr>
                <tr><td>二小区</td><td>10</td><td>0</td><td>1</td><td>10</td><td>45</td><td>788</td><td>18</td></tr>
                <tr><td>南坪东路女子医院</td><td>7</td><td>0</td><td>0</td><td>9</td><td>35</td><td>261</td><td>27</td></tr>
                <tr><td>福利社（小米熊儿童医院）</td><td>5</td><td>10</td><td>0</td><td>8</td><td>41</td><td>164</td><td>13</td></tr>

                <tr><td>海棠晓月</td><td>4</td><td>8</td><td>0</td><td>10</td><td>28</td><td>126</td><td>14</td></tr>
                <tr><td>海棠溪</td><td>4</td><td>5</td><td>0</td><td>10</td><td>17</td><td>216</td><td>17</td></tr>
                <tr><td>海棠溪新街</td><td>2</td><td>5</td><td>1</td><td>10</td><td>5</td><td>103</td><td>11</td></tr>
                <tr><td>上新街</td><td>2</td><td>3</td><td>1</td><td>8</td><td>31</td><td>136</td><td>11</td></tr>
                <tr><td>龙门浩</td><td>0</td><td>7</td><td>0</td><td>4</td><td>9</td><td>79</td><td>13</td></tr>
                <tr><td>上新街[轨道站]（一天门）</td><td>9</td><td>12</td><td>1</td><td>4</td><td>7</td><td>21</td><td>5</td></tr>
                <tr><td>下浩</td><td>0</td><td>0</td><td>0</td><td>4</td><td>3</td><td>15</td><td>3</td></tr>
                <tr><td>觉林寺</td><td>2</td><td>1</td><td>0</td><td>4</td><td>0</td><td>1</td><td>0</td></tr>
                <tr><td>涂山路中段（莲花公墓）</td><td>0</td><td>2</td><td>1</td><td>3</td><td>0</td><td>29</td><td>4</td></tr>
                <tr><td>市五医院</td><td>0</td><td>6</td><td>0</td><td>4</td><td>4</td><td>88</td><td>10</td></tr>
                <tr><td>涂山路</td><td>0</td><td>2</td><td>0</td><td>3</td><td>9</td><td>81</td><td>10</td></tr>
                <tr><td>涂山站[东海长洲]</td><td>3</td><td>6</td><td>1</td><td>4</td><td>10</td><td>96</td><td>8</td></tr>
                <tr><td>南岸大石坝</td><td>5</td><td>2</td><td>1</td><td>4</td><td>13</td><td>119</td><td>7</td></tr>
                <tr><td>十一中</td><td>5</td><td>7</td><td>0</td><td>5</td><td>35</td><td>96</td><td>12</td></tr>
                <tr><td>腾龙大道</td><td>1</td><td>0</td><td>1</td><td>4</td><td>3</td><td>25</td><td>3</td></tr>
                <tr><td>开泰路首末站</td><td>7</td><td>2</td><td>0</td><td>1</td><td>25</td><td>134</td><td>6</td></tr>
            </table>
        </div>
    </div>

    <!-- 熵权法赋权 -->
    <div id="Weight" class="tabcontent">
        <h3>指标权重分配</h3>
        <p>基于熵权法的权重计算结果见下表，分析显示，各指标对站点综合效益的影响差异显著。其中，“是否为轨道接驳站点”权重最高（21.976%），凸显了轨道交通衔接在公交站点效能中的核心作用；平峰与高峰客流指标分别贡献19.85%和13.37%的权重，反映时段客流均衡性的重要性；商业POI密度（16.43%）和住宅POI密度（11.72%）对站点活力具有较强解释力，而文化POI权重最低（7.29%），表明其对站点评价影响相对有限。熵权法结果符合城市公交站点“客流主导、用地协同”的典型特征。</p>
        <table>
            <tr><th>评价指标</th><th>信息熵值e</th><th>信息效用值d</th><th>权重(%)</th></tr>
            <tr><td>平峰站点上下车客流</td><td>0.78</td><td>0.22</td><td>19.85</td></tr>
            <tr><td>高峰站点上下车客流</td><td>0.852</td><td>0.148</td><td>13.371</td></tr>
            <tr><td>是否为轨道接驳站点</td><td>0.756</td><td>0.244</td><td>21.976</td></tr>
            <tr><td>覆盖公交线路数量</td><td>0.896</td><td>0.104</td><td>9.374</td></tr>
            <tr><td>站点300m半径内住宅POI数量</td><td>0.87</td><td>0.13</td><td>11.715</td></tr>
            <tr><td>站点300m半径内商业POI数量</td><td>0.818</td><td>0.182</td><td>16.427</td></tr>
            <tr><td>站点300m半径内文化POI数量</td><td>0.919</td><td>0.081</td><td>7.287</td></tr>
        </table>
    </div>

    <!-- RSR分布 -->
    <div id="RSR" class="tabcontent">
        <h3>非整秩法计算结果</h3>
        <p>相比整秩法，该方法能更精确地反映指标值的相对差异。从而克服了 RSR 法秩次化时易损失原指标值定量信息的缺点。例如“高峰站点上下车客流”指标中，最大值（万寿站）赋秩21，最小值（下浩站）赋秩1，中间值按比例插值，避免整秩法的信息损失。轨道接驳属性（二元变量）直接以21（是）或1（否）赋秩，强化枢纽站点的区分度。通过非整秩法构建秩矩阵（见附录表 ）后，计算得到各站点RSR值及其概率单位（Probit），见附录表 。结果显示，南坪（东路）站以RSR值0.769排名首位，其高峰客流秩次（R2=16）与轨道接驳属性（R3=21）表现突出；万寿站因平峰客流（R1=21）和商业POI（R6=18.79）优势位列第二；而下浩站因所有指标秩次均处于末位（如R5=1.95），RSR值仅为0.072，排名垫底。RSR分布表进一步揭示了站点效能的梯度差异，Probit值跨度从3.33（下浩站）至7.26（南坪站），符合右偏态分布特征。</p>
        <div class="scroll-table">
            <table style="min-width: 800px">
                <tr><th>站点名称</th><th>排名</th><th>Probit值</th><th>RSR拟合值</th></tr>
                <tr><td>南坪（东路）</td><td>1</td><td>7.260188991329377</td><td>0.7692681704873968</td></tr>
                <tr><td>万寿站</td><td>2</td><td>6.668391193947079</td><td>0.6524149090400396</td></tr>
                <tr><td>上新街[轨道站]（一天门）</td><td>4</td><td>6.067570523878141</td><td>0.5337800388984261</td></tr>
                <tr><td>二小区</td><td>3</td><td>6.309171716785777</td><td>0.581485331965936</td></tr>
                <tr><td>南坪东路女子医院</td><td>13</td><td>4.819987630207295</td><td>0.28743892256406767</td></tr>
                <tr><td>福利社</td><td>9</td><td>5.302980448056206</td><td>0.3828081285174233</td></tr>
                <tr><td>腾龙大道</td><td>12</td><td>4.940282900214677</td><td>0.31119179001175157</td></tr>
                <tr><td>十一中</td><td>14</td><td>4.697019551943794</td><td>0.2631582965418632</td></tr>
                <tr><td>南岸大石坝</td><td>8</td><td>5.430727299295458</td><td>0.4080323457635272</td></tr>
                <tr><td>涂山站[东海长洲]</td><td>7</td><td>5.565948821932863</td><td>0.43473247207009924</td></tr>
                <tr><td>市五医院</td><td>18</td><td>4.123857150753159</td><td>0.14998468181335456</td></tr>
                <tr><td>涂山路中段（莲花公墓）</td><td>10</td><td>5.1800123697927045</td><td>0.3585275024952187</td></tr>
                <tr><td>开泰路首末站</td><td>16</td><td>4.434051178067137</td><td>0.21123395298918723</td></tr>
                <tr><td>龙门浩</td><td>17</td><td>4.287556967610511</td><td>0.18230798139765403</td></tr>
                <tr><td>上新街</td><td>5</td><td>5.876142849246841</td><td>0.4959817432459318</td></tr>
                <tr><td>海棠溪新街</td><td>6</td><td>5.712443032389489</td><td>0.46365844366163234</td></tr>
                <tr><td>海棠溪</td><td>15</td><td>4.569272700704542</td><td>0.23793407929575916</td></tr>
                <tr><td>海棠晓月</td><td>11</td><td>5.059717099785323</td><td>0.3347746350475348</td></tr>
                <tr><td>下浩</td><td>21</td><td>3.3316088060529205</td><td>-0.006448484</td></tr>
                <tr><td>涂山路</td><td>19</td><td>3.9324294761218583</td><td>0.11218638616086019</td></tr>
                <tr><td>觉林寺</td><td>20</td><td>3.690828283214223</td><td>0.06448109309335048</td></tr>
            </table>
        </div>
    </div>
    <div id="Regression" class="tabcontent">
        <h3>线性回归分析</h3>
        <p>以Probit值为自变量、RSR值为因变量进行线性回归分析，结果如下表所示：</p>
        <div class="scroll-table">
            <table style="min-width: 800px">
                <tr>
                    <th></th>
                    <th colspan="2">非标准化系数</th>
                    <th>标准化系数</th>
                    <th>t</th>
                    <th>P</th>
                    <th>VIF</th>
                    <th>R²</th>
                    <th>调整R²</th>
                    <th>F</th>
                </tr>
                <tr>
                    <td></td>
                    <td>B</td>
                    <td>标准误</td>
                    <td>Beta</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>常数</td>
                    <td>-0.664</td>
                    <td>0.063</td>
                    <td>-</td>
                    <td>-10.608</td>
                    <td>0.000***</td>
                    <td>-</td>
                    <td>0.934</td>
                    <td>0.931</td>
                    <td>F=268.847 P=0.000***</td>
                </tr>
                <tr>
                    <td>Probit</td>
                    <td>0.197</td>
                    <td>0.012</td>
                    <td>0.966</td>
                    <td>16.397</td>
                    <td>0.000***</td>
                    <td>1</td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
            </table>
        </div>
        <p style="font-size: 0.9em; margin-top: 5px;">注：***、**、*分别代表1%、5%、10%的显著性水平</p>
        
        <!-- 添加线性回归拟合图 -->
        <div style="text-align: center; margin: 20px 0;">
            <figure>
                <img src="images\线性回归拟合.png" alt="线性回归拟合图" style="max-width: 90%; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                <figcaption style="margin-top: 10px; font-style: italic; color: #555;">Probit值与RSR值的线性回归拟合曲线</figcaption>
            </figure>
        </div>
        
        <h3>分档分析</h3>
        <p>以Probit值为自变量、RSR值为因变量的线性回归结果见下表，拟合合优度（R²=0.934）显著，拟合曲线如下图，回归方程RSR=-0.664+0.197×Probit通过F检验，且VIF值均小于5，模型无多重共线性问题。根据分档临界值（表5）划分，划分结果如表6：第3档（高效站点）包括南坪（东路）、万寿站等4个站点，其RSR拟合值均超过0.52，具备高客流与强轨道接驳双重优势；第2档（中效站点）占多数（如南坪东路女子医院、福利社站等），RSR值介于0.13-0.52之间；第1档（低效站点）包含下浩、涂山路和觉林寺三站，其RSR值低于0.1255，与客流稀疏、无接驳功能的现状一致。分档结果与前期满载率分析结论相互印证，为站点优化提供量化依据。</p>
        <table>
            <tr><th>分档</th><th>RSR范围</th><th>站点数量</th><th>站点列表</th></tr>
            <tr><td>高效站点</td><td>&gt;0.52</td><td>4</td><td>南坪（东路）、万寿站、上新街[轨道站]（一天门）、二小区</td></tr>
            <tr><td>中效站点</td><td>0.13-0.52</td><td>14</td><td>南坪东路女子医院、福利社、腾龙大道、十一中、南岸大石坝、涂山站[东海长洲]、市五医院、涂山路中段（莲花公墓）、开泰路首末站、龙门浩、上新街、海棠溪新街、海棠溪、海棠晓月</td></tr>
            <tr><td>低效站点</td><td>&lt;0.13</td><td>3</td><td>下浩、涂山路、觉林寺</td></tr>
        </table>
    </div>

    <script>
        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }
        // 默认打开第一个标签页
        document.getElementsByClassName('tablinks')[0].click();
    </script>

    <!-- 在分档分析后添加地图可视化标签页 -->
    <div id="Map" class="tabcontent">
        <h3>304公交线路站点分级可视化</h3>
        <p>下图展示了304公交线路的站点分布及其效能等级。高效站点（红色）主要集中在南坪商圈及轨道接驳点，中效站点（黄色）沿线分布，低效站点（蓝色）多位于线路末端。点击站点可查看详细信息。</p>
        
        <!-- 移除静态地图概览 -->
        
        <div id="mapContainer" style="width: 100%; height: 600px; border: 1px solid #ccc; margin-bottom: 20px;"></div>
        
        <!-- 美化站点信息显示区域 -->
        <div id="stationInfo" style="padding: 15px; background: #f5f5f5; border-radius: 5px; display: none; box-shadow: 0 3px 10px rgba(0,0,0,0.2); margin-top: 20px; border: 1px solid #ddd;">
            <h4 id="stationName" style="margin-top: 0; color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 8px;">站点信息</h4>
            <table id="stationData" style="width: 100%; background: white; margin-top: 10px;">
                <tr>
                    <th style="background: #2c3e50; color: white;">指标</th>
                    <th style="background: #2c3e50; color: white;">数值</th>
                </tr>
            </table>
        </div>
        
        <!-- 替换百度地图API为高德地图API -->
        <script type="text/javascript" src="https://webapi.amap.com/maps?v=2.0&key=865dbe7253fdd8c89f5c914ad355afac"></script>
        <script>
            // 在地图标签页被激活时初始化地图
            document.querySelector('button[onclick="openTab(event, \'Map\')"]').addEventListener('click', initMap);
            
            function initMap() {
                // 如果地图已经初始化，则不再重复初始化
                if (window.mapInitialized) return;
                window.mapInitialized = true;
                
                // 创建地图实例
                var map = new AMap.Map("mapContainer", {
                    // 设置中心点为重庆南坪
                    center: [106.570768, 29.52911],
                    zoom: 14,
                    viewMode: '3D'
                });
                
                // 添加控件
                map.plugin(['AMap.ToolBar', 'AMap.Scale'], function(){
                    map.addControl(new AMap.ToolBar());
                    map.addControl(new AMap.Scale());
                });
                
                // 站点数据（使用实际坐标）
                var stations = [
                    // 高效站点（3级）
                    {name: "南坪站", level: 3, position: [106.570768, 29.52911], 
                     data: {平峰客流: 22, 高峰客流: 9, 轨道接驳: "是", 公交线路数: 27, 住宅POI: 31, 商业POI: 594, 文化POI: 29, RSR值: 0.769, Probit值: 7.26}},
                    {name: "万寿路", level: 3, position: [106.561636, 29.527], 
                     data: {平峰客流: 30, 高峰客流: 0, 轨道接驳: "是", 公交线路数: 12, 住宅POI: 63, 商业POI: 701, 文化POI: 33, RSR值: 0.652, Probit值: 6.67}},
                    {name: "一天门", level: 3, position: [106.597897, 29.557139], 
                     data: {平峰客流: 9, 高峰客流: 12, 轨道接驳: "是", 公交线路数: 4, 住宅POI: 7, 商业POI: 21, 文化POI: 5, RSR值: 0.534, Probit值: 6.07}},
                    {name: "二小区", level: 3, position: [106.568474, 29.523325], 
                     data: {平峰客流: 10, 高峰客流: 0, 轨道接驳: "是", 公交线路数: 10, 住宅POI: 45, 商业POI: 788, 文化POI: 18, RSR值: 0.581, Probit值: 6.31}},
                    
                    // 中效站点（2级）
                    {name: "南坪东路", level: 2, position: [106.574042, 29.530158], 
                     data: {平峰客流: 7, 高峰客流: 0, 轨道接驳: "否", 公交线路数: 9, 住宅POI: 35, 商业POI: 261, 文化POI: 27, RSR值: 0.287, Probit值: 4.82}},
                    {name: "福利社·小米熊儿童医院", level: 2, position: [106.577997, 29.53578], 
                     data: {平峰客流: 5, 高峰客流: 10, 轨道接驳: "否", 公交线路数: 8, 住宅POI: 41, 商业POI: 164, 文化POI: 13, RSR值: 0.383, Probit值: 5.30}},
                    {name: "腾龙大道", level: 2, position: [106.594589, 29.587336], 
                     data: {平峰客流: 1, 高峰客流: 0, 轨道接驳: "是", 公交线路数: 4, 住宅POI: 3, 商业POI: 25, 文化POI: 3, RSR值: 0.311, Probit值: 4.94}},
                    {name: "十一中", level: 2, position: [106.59634, 29.579789], 
                     data: {平峰客流: 5, 高峰客流: 7, 轨道接驳: "否", 公交线路数: 5, 住宅POI: 35, 商业POI: 96, 文化POI: 12, RSR值: 0.263, Probit值: 4.70}},
                    {name: "南岸大石坝", level: 2, position: [106.600166, 29.576859], 
                     data: {平峰客流: 5, 高峰客流: 2, 轨道接驳: "是", 公交线路数: 4, 住宅POI: 13, 商业POI: 119, 文化POI: 7, RSR值: 0.408, Probit值: 5.43}},
                    {name: "东海长洲", level: 2, position: [106.601541, 29.574497], 
                     data: {平峰客流: 3, 高峰客流: 6, 轨道接驳: "是", 公交线路数: 4, 住宅POI: 10, 商业POI: 96, 文化POI: 8, RSR值: 0.435, Probit值: 5.57}},
                    {name: "五院", level: 2, position: [106.600815, 29.569458], 
                     data: {平峰客流: 0, 高峰客流: 6, 轨道接驳: "否", 公交线路数: 4, 住宅POI: 4, 商业POI: 88, 文化POI: 10, RSR值: 0.150, Probit值: 4.12}},
                    {name: "涂山路中段", level: 2, position: [106.601571, 29.565942], 
                     data: {平峰客流: 0, 高峰客流: 2, 轨道接驳: "是", 公交线路数: 3, 住宅POI: 0, 商业POI: 29, 文化POI: 4, RSR值: 0.359, Probit值: 5.18}},
                    {name: "开泰路首末站", level: 2, position: [106.596319, 29.590661], 
                     data: {平峰客流: 7, 高峰客流: 2, 轨道接驳: "否", 公交线路数: 1, 住宅POI: 25, 商业POI: 134, 文化POI: 6, RSR值: 0.211, Probit值: 4.43}},
                    {name: "龙门浩", level: 2, position: [106.59572, 29.552882], 
                     data: {平峰客流: 0, 高峰客流: 7, 轨道接驳: "否", 公交线路数: 4, 住宅POI: 9, 商业POI: 79, 文化POI: 13, RSR值: 0.182, Probit值: 4.29}},
                    {name: "上新街", level: 2, position: [106.594927, 29.549323], 
                     data: {平峰客流: 2, 高峰客流: 3, 轨道接驳: "是", 公交线路数: 8, 住宅POI: 31, 商业POI: 136, 文化POI: 11, RSR值: 0.496, Probit值: 5.88}},
                    {name: "海棠溪新街", level: 2, position: [106.59207, 29.544583], 
                     data: {平峰客流: 2, 高峰客流: 5, 轨道接驳: "是", 公交线路数: 10, 住宅POI: 5, 商业POI: 103, 文化POI: 11, RSR值: 0.464, Probit值: 5.71}},
                    {name: "海棠溪", level: 2, position: [106.588536, 29.542803], 
                     data: {平峰客流: 4, 高峰客流: 5, 轨道接驳: "否", 公交线路数: 10, 住宅POI: 17, 商业POI: 216, 文化POI: 17, RSR值: 0.238, Probit值: 4.57}},
                    {name: "海棠晓月", level: 2, position: [106.583622, 29.53866], 
                     data: {平峰客流: 4, 高峰客流: 8, 轨道接驳: "否", 公交线路数: 10, 住宅POI: 28, 商业POI: 126, 文化POI: 14, RSR值: 0.335, Probit值: 5.06}},
                    
                    // 低效站点（1级）
                    {name: "下浩", level: 1, position: [106.59861, 29.559345], 
                     data: {平峰客流: 0, 高峰客流: 0, 轨道接驳: "否", 公交线路数: 4, 住宅POI: 3, 商业POI: 15, 文化POI: 3, RSR值: -0.006, Probit值: 3.33}},
                    {name: "涂山路", level: 1, position: [106.60105, 29.573168], 
                     data: {平峰客流: 0, 高峰客流: 2, 轨道接驳: "否", 公交线路数: 3, 住宅POI: 9, 商业POI: 81, 文化POI: 10, RSR值: 0.112, Probit值: 3.93}},
                    {name: "觉林寺", level: 1, position: [106.599379, 29.561237], 
                     data: {平峰客流: 2, 高峰客流: 1, 轨道接驳: "否", 公交线路数: 4, 住宅POI: 0, 商业POI: 1, 文化POI: 0, RSR值: 0.064, Probit值: 3.69}}
                ];
                
                // 按照指定顺序重新排列站点路径
                var orderedStations = [
                    "南坪站", "万寿路", "二小区", "南坪东路", "福利社·小米熊儿童医院", 
                    "海棠晓月", "海棠溪", "海棠溪新街", "上新街", "龙门浩", 
                    "一天门", "下浩", "觉林寺", "涂山路中段", "五院", 
                    "涂山路", "东海长洲", "南岸大石坝", "十一中", "腾龙大道", 
                    "开泰路首末站"
                ];
                
                // 创建有序路径数组
                var orderedPath = [];
                orderedStations.forEach(function(stationName) {
                    var station = stations.find(s => s.name === stationName);
                    if (station) {
                        orderedPath.push(station.position);
                    }
                });
                
                // 绘制公交线路
                var polyline = new AMap.Polyline({
                    path: orderedPath,
                    strokeColor: "#3388ff",
                    strokeWeight: 6,
                    strokeOpacity: 0.8,
                    zIndex: 50
                });
                polyline.setMap(map);
                
                // 添加站点标记
                stations.forEach(function(station) {
                    // 根据站点等级设置不同颜色
                    var color;
                    switch(station.level) {
                        case 3: color = "#e74c3c"; break; // 高效站点-红色
                        case 2: color = "#f39c12"; break; // 中效站点-黄色
                        case 1: color = "#3498db"; break; // 低效站点-蓝色
                        default: color = "#95a5a6";
                    }
                    
                    // 创建标记
                    var marker = new AMap.Marker({
                        position: station.position,
                        title: station.name,
                        icon: new AMap.Icon({
                            size: new AMap.Size(16, 16),
                            image: 'data:image/svg+xml;base64,' + btoa('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"><circle cx="8" cy="8" r="7" fill="' + color + '" stroke="white" stroke-width="2"/></svg>'),
                            imageSize: new AMap.Size(16, 16)
                        }),
                        anchor: 'center'
                    });
                    
                    // 创建信息窗体 - 美化样式
                    var infoWindow = new AMap.InfoWindow({
                        isCustom: true,
                        content: createInfoWindowContent(station),
                        offset: new AMap.Pixel(0, -20),
                        autoMove: true,
                        closeWhenClickMap: true
                    });
                    
                    // 添加点击事件
                    marker.on('click', function() {
                        infoWindow.open(map, marker.getPosition());
                        showStationInfo(station);
                    });
                    
                    // 添加标签
                    var text = new AMap.Text({
                        text: station.name,
                        position: station.position,
                        offset: new AMap.Pixel(20, -10),
                        style: {
                            'background-color': 'rgba(255,255,255,0.9)',
                            'border': '1px solid #ccc',
                            'border-radius': '3px',
                            'padding': '5px',
                            'font-size': '12px',
                            'white-space': 'nowrap',
                            'box-shadow': '0 2px 6px rgba(0,0,0,0.1)'
                        }
                    });
                    
                    marker.setMap(map);
                    text.setMap(map);
                });
                
                // 添加图例
                var legendContainer = document.createElement('div');
                legendContainer.className = 'amap-legend';
                legendContainer.style.cssText = 'position: absolute; bottom: 20px; right: 20px; background: white; padding: 10px; border-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); z-index: 100;';
                legendContainer.innerHTML = `
                    <div style="margin-bottom: 5px; font-weight: bold;">站点等级</div>
                    <div style="display: flex; align-items: center; margin-bottom: 5px;">
                        <div style="width: 15px; height: 15px; background: #e74c3c; border-radius: 50%; margin-right: 5px;"></div>
                        <span>高效站点</span>
                    </div>
                    <div style="display: flex; align-items: center; margin-bottom: 5px;">
                        <div style="width: 15px; height: 15px; background: #f39c12; border-radius: 50%; margin-right: 5px;"></div>
                        <span>中效站点</span>
                    </div>
                    <div style="display: flex; align-items: center;">
                        <div style="width: 15px; height: 15px; background: #3498db; border-radius: 50%; margin-right: 5px;"></div>
                        <span>低效站点</span>
                    </div>
                `;
                document.getElementById('mapContainer').appendChild(legendContainer);
            }
            
            // 创建信息窗体内容 - 美化样式
            function createInfoWindowContent(station) {
                var levelName = getLevelName(station.level);
                var color;
                switch(station.level) {
                    case 3: color = "#e74c3c"; break;
                    case 2: color = "#f39c12"; break;
                    case 1: color = "#3498db"; break;
                    default: color = "#95a5a6";
                }
                
                return '<div style="padding: 12px; max-width: 250px; background: white; border-radius: 6px; box-shadow: 0 2px 10px rgba(0,0,0,0.2); border: 1px solid #ddd;">' +
                       '<h4 style="margin: 0 0 8px 0; color: ' + color + '; border-bottom: 2px solid ' + color + '; padding-bottom: 6px;">' + station.name + '</h4>' +
                       '<div style="font-size: 13px; color: #333; background: #f9f9f9; padding: 5px; border-radius: 3px; margin-bottom: 5px;">等级: <strong>' + levelName + '</strong></div>' +
                       '<div style="font-size: 13px; margin-top: 8px;">RSR值: <strong>' + station.data.RSR值.toFixed(3) + '</strong></div>' +
                       '<div style="font-size: 13px;">Probit值: <strong>' + station.data.Probit值.toFixed(2) + '</strong></div>' +
                       '<div style="font-size: 12px; margin-top: 8px; color: #666; text-align: center; background: #f5f5f5; padding: 4px; border-radius: 3px;">点击查看详细信息</div>' +
                       '</div>';
            }
            
            // 显示站点详细信息 - 美化样式
            function showStationInfo(station) {
                var infoDiv = document.getElementById("stationInfo");
                var nameElem = document.getElementById("stationName");
                var tableElem = document.getElementById("stationData");
                
                // 设置站点名称和颜色
                var color;
                switch(station.level) {
                    case 3: color = "#e74c3c"; break;
                    case 2: color = "#f39c12"; break;
                    case 1: color = "#3498db"; break;
                    default: color = "#95a5a6";
                }
                
                nameElem.textContent = station.name + " (等级: " + getLevelName(station.level) + ")";
                nameElem.style.color = color;
                nameElem.style.borderBottomColor = color;
                
                // 清空表格内容
                tableElem.innerHTML = "<tr><th style='background: #2c3e50; color: white;'>指标</th><th style='background: #2c3e50; color: white;'>数值</th></tr>";
                
                // 添加站点数据
                for (var key in station.data) {
                    var row = tableElem.insertRow();
                    var cell1 = row.insertCell(0);
                    var cell2 = row.insertCell(1);
                    cell1.textContent = key;
                    cell2.textContent = station.data[key];
                    
                    // 设置单元格样式
                    cell1.style.fontWeight = "bold";
                    cell1.style.backgroundColor = "#f5f5f5";
                    cell2.style.textAlign = "center";
                    
                    // 为特殊指标添加高亮
                    if (key === "RSR值" || key === "Probit值") {
                        cell1.style.backgroundColor = "#eaf2f8";
                        cell2.style.backgroundColor = "#eaf2f8";
                        cell2.style.fontWeight = "bold";
                        cell2.style.color = color;
                    }
                }
                
                // 显示信息区域
                infoDiv.style.display = "block";
                
                // 平滑滚动到信息区域
                infoDiv.scrollIntoView({behavior: "smooth"});
            }
            
            // 获取等级名称
            function getLevelName(level) {
                switch(level) {
                    case 3: return "高效站点";
                    case 2: return "中效站点";
                    case 1: return "低效站点";
                    default: return "未知";
                }
            }
        </script>
    </div>